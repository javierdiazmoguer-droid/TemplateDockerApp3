# Definir un VirtualHost que escucha en todos los interfaces en el puerto 80 (HTTP)
<VirtualHost *:80>
    # Nombre del servidor (se sustituye con la variable de entorno MOODLE_SERVER_NAME)
    ServerName ${SERVER_NAME}
    # Email del administrador del servidor
    ServerAdmin you@${SERVER_NAME}

    # Directorio raíz donde se encuentran los archivos de la aplicación
    DocumentRoot "${FOLDER_NAME}"
    # Configuración del directorio raíz
    <Directory "${FOLDER_NAME}">
        # Permitir listar índices y seguir enlaces simbólicos
        Options Indexes FollowSymLinks
        # Permitir sobrescribir configuración con archivos .htaccess
        AllowOverride All
        # Permitir acceso a todos
        Require all granted
        # Denegar acceso a archivos de configuración y control de versiones
        <FilesMatch "^\.(htaccess|htpasswd|ini|php|git)$">
            Require all denied
        </FilesMatch>
    </Directory>

    # Archivos índice por defecto (en orden de prioridad)
    DirectoryIndex index.php index.html info.php
        
    # Archivo de registro de errores
    ErrorLog /var/log/apache2/error_${SERVER_NAME}.log 
    # Archivo de registro de acceso
    CustomLog /var/log/apache2/access_${SERVER_NAME}.log combined
# Cierre de la configuración del VirtualHost
</VirtualHost>